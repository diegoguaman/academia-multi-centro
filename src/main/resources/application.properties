spring.application.name=academymanager

# Database Configuration (Supabase)
# 
# SECRETS PRIORITY (highest to lowest):
# 1. System environment variables (production, CI/CD, Docker, K8s)
# 2. .env file (development local - loaded by DotenvConfig)
# 3. application-dev.properties (if profile=dev)
# 4. Defaults below (fallback, no secrets)
#
# For production: Use environment variables or external secret managers (Vault, AWS Secrets Manager)
# For development: Use .env file (gitignored, secure)
#
spring.datasource.url=${DB_SUPABASE:jdbc:postgresql://localhost:5432/postgres}
spring.datasource.username=${DB_USERNAME:postgres}
spring.datasource.password=${DB_PASSWORD:}
spring.datasource.driver-class-name=org.postgresql.Driver

# JPA/Hibernate Configuration
# ddl-auto options: validate | update | create | create-drop | none
# - validate: Valida schema sin modificar (producción)
# - update: Actualiza schema automáticamente (desarrollo)
# - create: Crea schema desde cero (testing)
# - create-drop: Crea y elimina al finalizar (testing)
# - none: No hace nada (solo para casos especiales)
#
# TEMPORAL: Cambiado a 'update' para resolver problema de tipos (SERIAL vs BIGINT)
# TODO: Cambiar tipo en DB a BIGINT y volver a 'validate'
spring.jpa.hibernate.ddl-auto=validate
spring.jpa.show-sql=false
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.PostgreSQLDialect
spring.jpa.properties.hibernate.format_sql=true
spring.jpa.properties.hibernate.use_sql_comments=true
# PostgreSQL enum support: cast string values to enum type
spring.jpa.database-platform=org.hibernate.dialect.PostgreSQLDialect
spring.jpa.properties.hibernate.jdbc.lob.non_contextual_creation=true

# Connection Pool
spring.datasource.hikari.maximum-pool-size=10
spring.datasource.hikari.minimum-idle=5
spring.datasource.hikari.connection-timeout=20000
spring.datasource.hikari.idle-timeout=300000

# Logging
logging.level.com.academy.academymanager=DEBUG
logging.level.org.hibernate.SQL=DEBUG
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=TRACE

# JWT Configuration
jwt.secret.key=${JWT_SECRET_KEY:404E635266556A586E3272357538782F413F4428472B4B6250645367566B5970}
jwt.expiration.time=${JWT_EXPIRATION_TIME:86400000}

management.endpoints.web.exposure.include=health,info
management.endpoint.health.show-details=when-authorized
management.health.livenessState.enabled=true
management.health.readinessState.enabled=true

# GraphQL Configuration
spring.graphql.path=/graphql
spring.graphql.graphiql.enabled=true

# GraphiQL UI (graphiql-spring-boot-starter)
graphiql.enabled=true
graphiql.mapping=/graphiql